"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){var n=function(i,d){if(d.getElementsByClassName){var u,f,m=d.documentElement,o=i.Date,a=i.HTMLPictureElement,r="addEventListener",y="getAttribute",n=i[r],z=i.setTimeout,s=i.requestAnimationFrame||z,l=i.requestIdleCallback,v=/^picture$/i,c=["load","error","lazyincluded","_lazyloaded"],g={},h=Array.prototype.forEach,p=function(t,e){return g[e]||(g[e]=new RegExp("(\\s|^)"+e+"(\\s|$)")),g[e].test(t[y]("class")||"")&&g[e]},b=function(t,e){p(t,e)||t.setAttribute("class",(t[y]("class")||"").trim()+" "+e)},C=function(t,e){var n;(n=p(t,e))&&t.setAttribute("class",(t[y]("class")||"").replace(n," "))},A=function t(e,n,i){var a=i?r:"removeEventListener";i&&t(e,n),c.forEach(function(t){e[a](t,n)})},E=function(t,e,n,i,a){var o=d.createEvent("CustomEvent");return n||(n={}),n.instance=u,o.initCustomEvent(e,!i,!a,n),t.dispatchEvent(o),o},_=function(t,e){var n;!a&&(n=i.picturefill||f.pf)?n({reevaluate:!0,elements:[t]}):e&&e.src&&(t.src=e.src)},w=function(t,e){return(getComputedStyle(t,null)||{})[e]},M=function(t,e,n){for(n=n||t.offsetWidth;n<f.minSize&&e&&!t._lazysizesWidth;)n=e.offsetWidth,e=e.parentNode;return n},N=(At=[],Et=Ct=[],(wt=function(t,e){pt&&!e?t.apply(this,arguments):(Et.push(t),bt||(bt=!0,(d.hidden?z:s)(_t)))})._lsFlush=_t=function(){var t=Et;for(Et=Ct.length?At:Ct,bt=!(pt=!0);t.length;)t.shift()();pt=!1},wt),t=function(n,t){return t?function(){N(n)}:function(){var t=this,e=arguments;N(function(){n.apply(t,e)})}},S=function(t){var e,n,i=function(){e=null,t()},a=function t(){var e=o.now()-n;e<99?z(t,99-e):(l||i)(i)};return function(){n=o.now(),e||(e=z(a,99))}};!function(){var t,e={lazyClass:"lazyload",loadedClass:"lazyloaded",loadingClass:"lazyloading",preloadClass:"lazypreload",errorClass:"lazyerror",autosizesClass:"lazyautosizes",srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",minSize:40,customMedia:{},init:!0,expFactor:1.5,hFac:.8,loadMode:2,loadHidden:!0,ricTimeout:0,throttleDelay:125};for(t in f=i.lazySizesConfig||i.lazysizesConfig||{},e)t in f||(f[t]=e[t]);i.lazySizesConfig=f,z(function(){f.init&&x()})}();var e=(nt=/^img$/i,it=/^iframe$/i,at="onscroll"in i&&!/glebot/.test(navigator.userAgent),st=-1,lt=function t(e){rt--,e&&e.target&&A(e.target,t),(!e||rt<0||!e.target)&&(rt=0)},ct=function(t,e){var n,i=t,a="hidden"==w(d.body,"visibility")||"hidden"!=w(t,"visibility");for(I-=e,G+=e,q-=e,j+=e;a&&(i=i.offsetParent)&&i!=d.body&&i!=m;)(a=0<(w(i,"opacity")||1))&&"visible"!=w(i,"overflow")&&(n=i.getBoundingClientRect(),a=j>n.left&&q<n.right&&G>n.top-1&&I<n.bottom+1);return a},U=dt=function(){var t,e,n,i,a,o,r,s,l,c=u.elements;if((H=f.loadMode)&&rt<8&&(t=c.length)){e=0,st++,null==K&&("expand"in f||(f.expand=(0<m.clientHeight&&m.clientWidth,0)),J=f.expand,K=J*f.expFactor),ot<K&&rt<1&&2<st&&2<H&&!d.hidden?(ot=K,st=0):ot=1<H&&1<st&&rt<6?J:0;for(;e<t;e++)if(c[e]&&!c[e]._lazyRace)if(at)if((s=c[e][y]("data-expand"))&&(o=1*s)||(o=ot),l!==o&&(P=innerWidth+o*Q,$=innerHeight+o,r=-1*o,l=o),n=c[e].getBoundingClientRect(),(G=n.bottom)>=r&&(I=n.top)<=$&&(j=n.right)>=r*Q&&(q=n.left)<=P&&(G||j||q||I)&&(f.loadHidden||"hidden"!=w(c[e],"visibility"))&&(k&&rt<3&&!s&&(H<3||st<4)||ct(c[e],o))){if(gt(c[e]),a=!0,9<rt)break}else!a&&k&&!i&&rt<4&&st<4&&2<H&&(R[0]||f.preloadAfterLoad)&&(R[0]||!s&&(G||j||q||I||"auto"!=c[e][y](f.sizesAttr)))&&(i=R[0]||c[e]);else gt(c[e]);i&&!a&&gt(i)}},X=rt=ot=0,Y=f.throttleDelay,Z=f.ricTimeout,tt=function(){V=!1,X=o.now(),U()},et=l&&49<Z?function(){l(tt,{timeout:Z}),Z!==f.ricTimeout&&(Z=f.ricTimeout)}:t(function(){z(tt)},!0),ut=function(t){var e;(t=!0===t)&&(Z=33),V||(V=!0,(e=Y-(o.now()-X))<0&&(e=0),t||e<9?et():z(et,e))},mt=t(ft=function(t){b(t.target,f.loadedClass),C(t.target,f.loadingClass),A(t.target,yt),E(t.target,"lazyloaded")}),yt=function(t){mt({target:t.target})},zt=function(t){var e,n=t[y](f.srcsetAttr);(e=f.customMedia[t[y]("data-media")||t[y]("media")])&&t.setAttribute("media",e),n&&t.setAttribute("srcset",n)},vt=t(function(t,e,n,i,a){var o,r,s,l,c,d;(c=E(t,"lazybeforeunveil",e)).defaultPrevented||(i&&(n?b(t,f.autosizesClass):t.setAttribute("sizes",i)),r=t[y](f.srcsetAttr),o=t[y](f.srcAttr),a&&(s=t.parentNode,l=s&&v.test(s.nodeName||"")),d=e.firesLoad||"src"in t&&(r||o||l),c={target:t},d&&(A(t,lt,!0),clearTimeout(D),D=z(lt,2500),b(t,f.loadingClass),A(t,yt,!0)),l&&h.call(s.getElementsByTagName("source"),zt),r?t.setAttribute("srcset",r):o&&!l&&(it.test(t.nodeName)?function(e,n){try{e.contentWindow.location.replace(n)}catch(t){e.src=n}}(t,o):t.src=o),a&&(r||l)&&_(t,{src:o})),t._lazyRace&&delete t._lazyRace,C(t,f.lazyClass),N(function(){(!d||t.complete&&1<t.naturalWidth)&&(d?lt(c):rt--,ft(c))},!0)}),ht=function t(){if(!k){if(o.now()-O<999)return void z(t,999);var e=S(function(){f.loadMode=3,ut()});k=!0,f.loadMode=3,ut(),n("scroll",function(){3==f.loadMode&&(f.loadMode=2),e()},!0)}},{_:function(){O=o.now(),u.elements=d.getElementsByClassName(f.lazyClass),R=d.getElementsByClassName(f.lazyClass+" "+f.preloadClass),Q=f.hFac,n("scroll",ut,!0),n("resize",ut,!0),i.MutationObserver?new MutationObserver(ut).observe(m,{childList:!0,subtree:!0,attributes:!0}):(m[r]("DOMNodeInserted",ut,!0),m[r]("DOMAttrModified",ut,!0),setInterval(ut,999)),n("hashchange",ut,!0),["focus","mouseover","click","load","transitionend","animationend","webkitAnimationEnd"].forEach(function(t){d[r](t,ut,!0)}),/d$|^c/.test(d.readyState)?ht():(n("load",ht),d[r]("DOMContentLoaded",ut),z(ht,2e4)),u.elements.length?(dt(),N._lsFlush()):ut()},checkElems:ut,unveil:gt=function(t){var e,n=nt.test(t.nodeName),i=n&&(t[y](f.sizesAttr)||t[y]("sizes")),a="auto"==i;(!a&&k||!n||!t[y]("src")&&!t.srcset||t.complete||p(t,f.errorClass)||!p(t,f.lazyClass))&&(e=E(t,"lazyunveilread").detail,a&&W.updateElem(t,!0,t.offsetWidth),t._lazyRace=!0,rt++,vt(t,e,a,i,n))}}),W=(B=t(function(t,e,n,i){var a,o,r;if(t._lazysizesWidth=i,i+="px",t.setAttribute("sizes",i),v.test(e.nodeName||""))for(a=e.getElementsByTagName("source"),o=0,r=a.length;o<r;o++)a[o].setAttribute("sizes",i);n.detail.dataAttr||_(t,n.detail)}),F=function(t,e,n){var i,a=t.parentNode;a&&(n=M(t,a,n),i=E(t,"lazybeforesizes",{width:n,dataAttr:!!e}),i.defaultPrevented||(n=i.detail.width)&&n!==t._lazysizesWidth&&B(t,a,i,n))},{_:function(){T=d.getElementsByClassName(f.autosizesClass),n("resize",L)},checkElems:L=S(function(){var t,e=T.length;if(e)for(t=0;t<e;t++)F(T[t])}),updateElem:F}),x=function t(){t.i||(t.i=!0,W._(),e._())};return u={cfg:f,autoSizer:W,loader:e,init:x,uP:_,aC:b,rC:C,hC:p,fire:E,gW:M,rAF:N}}var T,B,F,L;var R,k,D,H,O,P,$,I,q,j,G,J,K,Q,U,V,X,Y,Z,tt,et,nt,it,at,ot,rt,st,lt,ct,dt,ut,ft,mt,yt,zt,vt,gt,ht;var pt,bt,Ct,At,Et,_t,wt}(t,t.document);t.lazySizes=n,"object"==("undefined"==typeof module?"undefined":_typeof(module))&&module.exports&&(module.exports=n)}(window);
"use strict";!function(){function u(n){return new Promise(function(e,t){n.onsuccess=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function i(n,o,r){var i,e=new Promise(function(e,t){u(i=n[o].apply(n,r)).then(e,t)});return e.request=i,e}function e(e,n,t){t.forEach(function(t){Object.defineProperty(e.prototype,t,{get:function(){return this[n][t]},set:function(e){this[n][t]=e}})})}function t(t,n,o,e){e.forEach(function(e){e in o.prototype&&(t.prototype[e]=function(){return i(this[n],e,arguments)})})}function n(t,n,o,e){e.forEach(function(e){e in o.prototype&&(t.prototype[e]=function(){return this[n][e].apply(this[n],arguments)})})}function o(e,o,t,n){n.forEach(function(n){n in t.prototype&&(e.prototype[n]=function(){return e=this[o],(t=i(e,n,arguments)).then(function(e){if(e)return new c(e,t.request)});var e,t})})}function r(e){this._index=e}function c(e,t){this._cursor=e,this._request=t}function s(e){this._store=e}function a(n){this._tx=n,this.complete=new Promise(function(e,t){n.oncomplete=function(){e()},n.onerror=function(){t(n.error)},n.onabort=function(){t(n.error)}})}function p(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new a(n)}function f(e){this._db=e}e(r,"_index",["name","keyPath","multiEntry","unique"]),t(r,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),o(r,"_index",IDBIndex,["openCursor","openKeyCursor"]),e(c,"_cursor",["direction","key","primaryKey","value"]),t(c,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(n){n in IDBCursor.prototype&&(c.prototype[n]=function(){var t=this,e=arguments;return Promise.resolve().then(function(){return t._cursor[n].apply(t._cursor,e),u(t._request).then(function(e){if(e)return new c(e,t._request)})})})}),s.prototype.createIndex=function(){return new r(this._store.createIndex.apply(this._store,arguments))},s.prototype.index=function(){return new r(this._store.index.apply(this._store,arguments))},e(s,"_store",["name","keyPath","indexNames","autoIncrement"]),t(s,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),o(s,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),n(s,"_store",IDBObjectStore,["deleteIndex"]),a.prototype.objectStore=function(){return new s(this._tx.objectStore.apply(this._tx,arguments))},e(a,"_tx",["objectStoreNames","mode"]),n(a,"_tx",IDBTransaction,["abort"]),p.prototype.createObjectStore=function(){return new s(this._db.createObjectStore.apply(this._db,arguments))},e(p,"_db",["name","version","objectStoreNames"]),n(p,"_db",IDBDatabase,["deleteObjectStore","close"]),f.prototype.transaction=function(){return new a(this._db.transaction.apply(this._db,arguments))},e(f,"_db",["name","version","objectStoreNames"]),n(f,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(i){[s,r].forEach(function(e){e.prototype[i.replace("open","iterate")]=function(){var e,t=(e=arguments,Array.prototype.slice.call(e)),n=t[t.length-1],o=this._store||this._index,r=o[i].apply(o,t.slice(0,-1));r.onsuccess=function(){n(r.result)}}})}),[r,s].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,n){var o=this,r=[];return new Promise(function(t){o.iterateCursor(e,function(e){e?(r.push(e.value),void 0===n||r.length!=n?e.continue():t(r)):t(r)})})})});var d={open:function(e,t,n){var o=i(indexedDB,"open",[e,t]),r=o.request;return r.onupgradeneeded=function(e){n&&n(new p(r.result,e.oldVersion,r.transaction))},o.then(function(e){return new f(e)})},delete:function(e){return i(indexedDB,"deleteDatabase",[e])}};"undefined"!=typeof module?(module.exports=d,module.exports.default=module.exports):self.idb=d}();
"use strict";var dbPromise=idb.open("keyval-store",1,function(e){e.createObjectStore("keyval")}),dbReviews=idb.open("reviews-store",1,function(e){e.createObjectStore("reviewsdb")}),idbKeyval={get:function(t){return dbPromise.then(function(e){return e.transaction("keyval").objectStore("keyval").get(t)})},set:function(r,n){return dbPromise.then(function(e){var t=e.transaction("keyval","readwrite");return t.objectStore("keyval").put(n,r),t.complete})},delete:function(r){return dbPromise.then(function(e){var t=e.transaction("keyval","readwrite");return t.objectStore("keyval").delete(r),t.complete})},clear:function(){return dbPromise.then(function(e){var t=e.transaction("keyval","readwrite");return t.objectStore("keyval").clear(),t.complete})},keys:function(){return dbPromise.then(function(e){var t=e.transaction("keyval"),r=[],n=t.objectStore("keyval");return(n.iterateKeyCursor||n.iterateCursor).call(n,function(e){e&&(r.push(e.key),e.continue())}),t.complete.then(function(){return r})})}},idbReviews={get:function(t){return dbReviews.then(function(e){return e.transaction("reviewsdb").objectStore("reviewsdb").get(t)})},set:function(r,n){return dbReviews.then(function(e){var t=e.transaction("reviewsdb","readwrite");return t.objectStore("reviewsdb").put(n,r),t.complete})},delete:function(r){return dbReviews.then(function(e){var t=e.transaction("reviewsdb","readwrite");return t.objectStore("reviewsdb").delete(r),t.complete})},clear:function(){return dbReviews.then(function(e){var t=e.transaction("reviewsdb","readwrite");return t.objectStore("reviewsdb").clear(),t.complete})},keys:function(){return dbReviews.then(function(e){var t=e.transaction("reviewsdb"),r=[],n=t.objectStore("reviewsdb");return(n.iterateKeyCursor||n.iterateCursor).call(n,function(e){e&&(r.push(e.key),e.continue())}),t.complete.then(function(){return r})})}};
"use strict";var _createClass=function(){function r(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,n,t){return n&&r(e.prototype,n),t&&r(e,t),e}}();function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var DBHelper=function(){function o(){_classCallCheck(this,o)}return _createClass(o,null,[{key:"fetchRestaurants",value:function(t){var r=new XMLHttpRequest;r.open("GET",o.DATABASE_URL_restaurants),r.onreadystatechange=function(){4==this.readyState&&(r.onload=function(){if(200===r.status){var e=JSON.parse(r.responseText);for(var n in idbKeyval.clear(),e)idbKeyval.set(e[n].id,e[n]);t(null,e)}else{r.status;dbPromise.then(function(e){return e.transaction("keyval").objectStore("keyval").getAll()}).then(function(e){return t(null,e)})}},""==r.response&&dbPromise.then(function(e){return e.transaction("keyval").objectStore("keyval").getAll()}).then(function(e){return t(null,e)}))},r.send()}},{key:"fetchReviews",value:function(e,n){var t=new XMLHttpRequest;t.open("GET","http://localhost:1337/reviews/?restaurant_id="+e),t.onreadystatechange=function(){4==this.readyState&&(t.onload=function(){if(200===t.status){var e=JSON.parse(t.responseText);n(null,e)}})},t.send()}},{key:"checkConnection",value:function(){var t=new XMLHttpRequest;t.open("GET","http://localhost:1337/reviews"),t.onreadystatechange=function(){4==this.readyState&&(t.onload=function(){200===t.status&&dbReviews.then(function(e){return e.transaction("reviewsdb").objectStore("reviewsdb").getAll()}).then(function(e){for(var n in e)t.open("POST","http://localhost:1337/reviews",!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.send(e[n]);idbReviews.clear()})})},t.send()}},{key:"fetchRestaurantById",value:function(r,a){o.fetchRestaurants(function(e,n){if(e)a(e,null);else{var t=n.find(function(e){return e.id==r});t?a(null,t):a("Restaurant does not exist",null)}})}},{key:"fetchRestaurantByCuisine",value:function(r,a){o.fetchRestaurants(function(e,n){if(e)a(e,null);else{var t=n.filter(function(e){return e.cuisine_type==r});a(null,t)}})}},{key:"fetchRestaurantByNeighborhood",value:function(r,a){o.fetchRestaurants(function(e,n){if(e)a(e,null);else{var t=n.filter(function(e){return e.neighborhood==r});a(null,t)}})}},{key:"fetchRestaurantByCuisineAndNeighborhood",value:function(r,a,u){o.fetchRestaurants(function(e,n){if(e)u(e,null);else{var t=n;"all"!=r&&(t=t.filter(function(e){return e.cuisine_type==r})),"all"!=a&&(t=t.filter(function(e){return e.neighborhood==a})),u(null,t)}})}},{key:"fetchNeighborhoods",value:function(a){o.fetchRestaurants(function(e,t){if(e)a(e,null);else{var r=t.map(function(e,n){return t[n].neighborhood}),n=r.filter(function(e,n){return r.indexOf(e)==n});a(null,n)}})}},{key:"fetchCuisines",value:function(a){o.fetchRestaurants(function(e,t){if(e)a(e,null);else{var r=t.map(function(e,n){return t[n].cuisine_type}),n=r.filter(function(e,n){return r.indexOf(e)==n});a(null,n)}})}},{key:"urlForRestaurant",value:function(e){return"./restaurant.html?id="+e.id}},{key:"imageUrlForRestaurant",value:function(e){return"/img/"+e.photograph+".webp"}},{key:"smallImageUrlForRestaurant",value:function(e){return"/img/small/"+e.photograph+".webp"}},{key:"mapMarkerForRestaurant",value:function(e,n){return new google.maps.Marker({position:e.latlng,title:e.name,url:o.urlForRestaurant(e),map:n,animation:google.maps.Animation.DROP})}},{key:"DATABASE_URL_restaurants",get:function(){return"http://localhost:1337/restaurants"}}]),o}();window.addEventListener("online",function(e){console.log("online"),DBHelper.checkConnection()});
"use strict";var map,restaurants=void 0,neighborhoods=void 0,cuisines=void 0,markers=[];document.addEventListener("DOMContentLoaded",function(e){fetchNeighborhoods(),fetchCuisines()});var fetchNeighborhoods=function(){DBHelper.fetchNeighborhoods(function(e,t){e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})},fillNeighborhoodsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.neighborhoods,n=document.getElementById("neighborhoods-select");e.forEach(function(e){var t=document.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})},fetchCuisines=function(){DBHelper.fetchCuisines(function(e,t){e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})},fillCuisinesHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.cuisines,n=document.getElementById("cuisines-select");e.forEach(function(e){var t=document.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})};window.initMap=function(){self.map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1})};var updateRestaurants=function(){var e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),n=e.selectedIndex,r=t.selectedIndex,a=e[n].value,s=t[r].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(a,s,function(e,t){e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())})},resetRestaurants=function(e){self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers.forEach(function(e){return e.setMap(null)}),self.markers=[],self.restaurants=e},fillRestaurantsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants,t=document.getElementById("restaurants-list");e.forEach(function(e){t.append(createRestaurantHTML(e))}),e.forEach(function(e){createHTMLImages(e)}),addMarkersToMap(),t.setAttribute("role","list")},createRestaurantHTML=function(e){var t=document.createElement("li"),n=document.createElement("div");n.innerHTML="<div onClick = 'favouriteToggle(this, "+e.id+")'></div>",n.classList.add("favourite"),e.is_favorite&&n.children[0].classList.add("active"),t.append(n);var r=document.createElement("picture");r.id="picture-"+e.id,t.append(r);var a=document.createElement("h3");a.innerHTML=e.name,a.setAttribute("tabindex","0"),t.append(a);var s=document.createElement("p");s.innerHTML=e.neighborhood,s.setAttribute("tabindex","0"),t.append(s);var i=document.createElement("p");i.innerHTML=e.address,i.setAttribute("tabindex","0"),t.append(i);var o=document.createElement("a");return o.innerHTML="View Details",o.href=DBHelper.urlForRestaurant(e),o.setAttribute("aria-label","View restaurant details"),t.append(o),t.setAttribute("aria-label","Restaurant information"),t.setAttribute("tabindex","0"),t},createHTMLImages=function(e){var t="picture-"+e.id,n=document.getElementById(t),r=document.createElement("source");r.setAttribute("data-srcset",DBHelper.smallImageUrlForRestaurant(e)),r.setAttribute("media","(max-width: 674px)"),n.appendChild(r);var a=document.createElement("source");a.setAttribute("data-srcset",DBHelper.imageUrlForRestaurant(e)),a.setAttribute("media","(min-width: 675px)"),n.appendChild(a);var s=document.createElement("img");s.className="restaurant-img",s.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",s.setAttribute("data-src",DBHelper.imageUrlForRestaurant(e)),s.setAttribute("alt",e.name),s.classList.add("lazyload"),n.appendChild(s)},addMarkersToMap=function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants).forEach(function(e){var t=DBHelper.mapMarkerForRestaurant(e,self.map);google.maps.event.addListener(t,"click",function(){window.location.href=t.url}),self.markers.push(t)})},favouriteToggle=function(e,t){var n=new XMLHttpRequest;e.classList.contains("active")?(n.open("PUT","http://localhost:1337/restaurants/"+t+"/"),n.setRequestHeader("Content-Type","application/json"),n.onload=function(){200===n.status&&e.classList.remove("active")},n.send(JSON.stringify({is_favorite:!1}))):(n.open("PUT","http://localhost:1337/restaurants/"+t+"/"),n.setRequestHeader("Content-Type","application/json"),n.onload=function(){200===n.status&&e.classList.add("active")},n.send(JSON.stringify({is_favorite:!0})))};"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("sw.js").then(function(e){console.log("ServiceWorker registration successful with scope: ",e.scope)},function(e){console.log("ServiceWorker registration failed: ",e)}),navigator.serviceWorker.ready.then(function(e){return e.sync.register("myFirstSync")})});